<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>PAR The Chabauty-Coleman method</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/x-mathjax-config">
MathJax.Ajax.config.path["Contrib"] = "//cdn.rawgit.com/mathjax/MathJax-third-party-extensions/22087770";
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']],
    },
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://aimath.org/mathbook/mathjaxknowl.js", "[Contrib]/xyjax/xypic.js", "AMSmath.js", "AMSsymbols.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none",
                           useLabelIds: true,
                           // JS comment, XML CDATA protect XHTML quality of file
                           // if removed in XSL, use entities
                           //<![CDATA[
                           formatID: function (n) {return String(n).replace(/[:'"<>&]/g,"")},
                           //]]>
                         },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.12/pretext.js"></script><script src="https://pretextbook.org/js/0.12/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/toc.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/setcolors.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="https://alexjbest.github.io/css/pretext.css">
<link href="https://pretextbook.org/css/0.2/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.12;
</script>
</head>
<body class="mathbook-article has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\require{xypic}\require{newpxtext}\require{newpxmath}\require{cancel}\require{pgfplots}

\newenvironment{smallermatrix}[1]
{\arraycolsep=0.5pt\def\arraystretch{0.5}\tiny
\array{#1}}
{\endarray}

\def\coloneqq{\mathrel{\mathop:}\mathrel{\mkern-1.2mu}=}
\def\eqqcolon{=\mathrel{\mkern-1.2mu}\mathrel{\mathop:}}




\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\newcommand{\ideal}[1]{\mathfrak{#1}}
\newcommand{\lie}[1]{\operatorname{\mathfrak{#1}}}
\newcommand{\sheaf}[1]{\operatorname{\mathcal{#1}}}
\DeclareMathOperator{\Lie}{Lie}

\newcommand{\diff}{\mathop{}\!\mathrm{d}}
\newcommand{\cinf}{C^\infty}
\newcommand{\inv}{^{-1}}
\newcommand{\units}{^{\times}}

\newcommand{\legendre}[2]{\left(\frac{#1}{#2}\right)}
\newcommand{\pair}[2]{\left\langle #1, #2 \right\rangle}
\newcommand{\lb}{[}
\newcommand{\rb}{]}
\newcommand{\powerseries}[2]{#1[[#2]]}


\newcommand{\partder}[2][]{\frac{\partial #1}{\partial #2}}


\providecommand\mapsfrom{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}
\DeclareMathOperator{\Sha}{III}


\newcommand{\NN}{\mathbf{N}}
\newcommand{\ZZ}{\mathbf{Z}}
\newcommand{\QQ}{\mathbf{Q}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\CC}{\mathbf{C}}
\newcommand{\HH}{\mathbf{H}}
\newcommand{\FF}{\mathbf{F}}
\newcommand{\GG}{\mathbf{G}}
\newcommand{\ints}{\mathcal{O}}
\newcommand{\adeles}{\mathbf{A}}

\newcommand{\alg}{\mathrm{alg}}

\newcommand{\subgroup}{\mathrel{\subseteq}}

\newcommand{\cat}[1]{\mathcal{#1}}
\newcommand{\catname}[1]{{\mathrm\textbf{#1}}}
\newcommand{\Rings}{\mathrm{Rings}}

\newcommand{\Ar}{\mathrm{Ar}}
\newcommand{\dR}{\mathrm{dR}}
\newcommand{\crys}{\mathrm{crys}}
\newcommand{\cris}{\mathrm{cris}}
\newcommand{\et}{\mathrm{\acute{e}t}}
\newcommand{\rig}{\mathrm{rig}}
\newcommand{\sing}{\mathrm{sing}}
\newcommand{\Pet}{\mathrm{Pet}}

\newcommand{\pinf}{{1/p^\infty}}

\newcommand{\colim}{\operatornamewithlimits{\underset{\longrightarrow}{colim}}}
\newcommand{\acts}{\circlearrowright}
\newcommand\rightrightrightarrows{
    \mathrel{\substack{\textstyle\rightarrow\\[-0.6ex]
        \textstyle\rightarrow \\[-0.6ex]
        \textstyle\rightarrow}}
}

\newcommand{\ab}{\mathrm{ab}}
\newcommand{\alm}{\mathrm{a}}
\newcommand{\an}{\mathrm{an}}
\newcommand{\alt}{\mathrm{alt}}
\newcommand{\cyc}{\mathrm{cyc}}
\newcommand{\divisible}{\mathrm{div}}
\newcommand{\id}{\mathrm{id}}
\newcommand{\un}{\mathrm{un}}
\newcommand{\nr}{\mathrm{nr}}
\newcommand{\ns}{\mathrm{ns}}
\newcommand{\op}{\mathrm{op}}
\newcommand{\pre}{\mathrm{pre}}
\newcommand{\reg}{\mathrm{reg}}
\newcommand{\spec}{\mathrm{spec}}
\newcommand{\Set}{\mathrm{Set}}
\newcommand{\sep}{\mathrm{sep}}
\newcommand{\St}{\mathrm{St}}
\newcommand{\tors}{\mathrm{tors}}
\newcommand{\transpose}{\mathrm{T}}


\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\Ass}{Ass}
\DeclareMathOperator{\Supp}{Supp}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\Hom}{Hom}
\newcommand{\sheafHom}{\mathscr{Hom}}
\DeclareMathOperator{\Nat}{Nat}
\DeclareMathOperator{\Br}{Br}
\DeclareMathOperator{\Syl}{Syl}
\DeclareMathOperator{\Tgt}{Tgt}
\DeclareMathOperator{\sprep}{sp}
\DeclareMathOperator{\vol}{Vol}

\DeclareMathOperator{\divisor}{div}
\DeclareMathOperator{\divisors}{Div}
\DeclareMathOperator{\Div}{Div} 
\DeclareMathOperator{\Cl}{Cl}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\Jac}{Jac}
\DeclareMathOperator{\Princ}{Princ}
\DeclareMathOperator{\Cycles}{Cycles}
\DeclareMathOperator{\supp}{supp}

\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Tor}{Tor}

\DeclareMathOperator{\gr}{gr}
\DeclareMathOperator{\Fil}{Fil}


\DeclareMathOperator{\polylog}{\mathcal{L}}

\DeclareMathOperator{\disc}{disc}

\DeclareMathOperator{\Tan}{Tan}
\DeclareMathOperator{\Cotan}{Cotan}
\DeclareMathOperator{\Sing}{Sing}

\DeclareMathOperator{\Sel}{Sel}
\DeclareMathOperator{\redu}{red}
\DeclareMathOperator{\Reg}{Reg}
\DeclareMathOperator{\Rep}{Rep}

\DeclareMathOperator{\rk}{rk}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\coim}{coim}
\DeclareMathOperator{\codim}{codim}
\DeclareMathOperator{\Span}{span}
\DeclareMathOperator{\characteristic}{char}
\DeclareMathOperator{\orient}{or}
\DeclareMathOperator{\leadterm}{lt}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\Ad}{Ad}

\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Proj}{Proj}
\DeclareMathOperator{\Spf}{Spf}
\DeclareMathOperator{\Spv}{Spv}
\DeclareMathOperator{\Spa}{Spa}
\DeclareMathOperator{\Spm}{Spm}
\DeclareMathOperator{\specialisation}{sp}
\DeclareMathOperator{\Max}{Max}
\newcommand{\Gal}[2]{\operatorname{Gal}(#1/#2)}
\newcommand{\absgal}[1]{\operatorname{Gal}(\overline{#1}/#1)}
\newcommand{\sepgal}[1]{\operatorname{Gal}(#1^\sep/#1)}
\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\Res}{Res}


\DeclareMathOperator{\power}{\mathcal{P}}
\DeclareMathOperator{\aff}{\mathbf{A}}
\DeclareMathOperator{\PP}{\mathbf{P}}
\DeclareMathOperator{\norm}{Norm}
\DeclareMathOperator{\trace}{Tr}
\DeclareMathOperator{\Fr}{Fr}
\DeclareMathOperator{\Frob}{Frob}
\DeclareMathOperator{\NS}{NS}
\DeclareMathOperator{\Der}{Der}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Out}{Out}
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\vf}{\mathcal{V}}
\DeclareMathOperator{\krulldim}{krulldim}
\DeclareMathOperator{\trdeg}{trdeg}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Prob}{Prob}

\DeclareMathOperator{\Mat}{Mat}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\PSL}{PSL}
\DeclareMathOperator{\PGL}{PGL}
\DeclareMathOperator{\specialorthogonal}{SO}
\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\USp}{USp}
\DeclareMathOperator{\orth}{O}
\DeclareMathOperator{\unitary}{U}
\DeclareMathOperator{\specialunitary}{SU}
\DeclareMathOperator{\Sym}{Sym}

\DeclareMathOperator{\Aff}{Aff}

\DeclareMathOperator{\ch}{ch}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="p-adic-methods.html"><span class="title">\(p\)-adic methods for rational points on curves:</span> <span class="subtitle">MA841 at BU Fall 2019</span></a></h1>
<p class="byline">Jennifer Balakrishnan</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="sec-p-adic-rat-pts.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="p-adic-methods.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="backmatter-1.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="sec-p-adic-rat-pts.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="p-adic-methods.html" title="Up">Up</a><a class="next-button button toolbar-item" href="backmatter-1.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link"><a href="frontmatter-1.html" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a></li>
<li class="link"><a href="sec-p-adic-rat-pts.html" data-scroll="sec-p-adic-rat-pts"><span class="codenumber">1</span> <span class="title">Rational points on curves</span></a></li>
<li class="link active">
<a href="sec-chab-coleman.html" data-scroll="sec-chab-coleman"><span class="codenumber">2</span> <span class="title">The Chabauty-Coleman method</span></a><ul>
<li><a href="sec-chab-coleman.html#subsec-triangles" data-scroll="subsec-triangles">A question about triangles</a></li>
<li><a href="sec-chab-coleman.html#subsection-2" data-scroll="subsection-2">Why care about \(X(\QQ)\) for \(X\) of genus 2?</a></li>
<li><a href="sec-chab-coleman.html#subsection-3" data-scroll="subsection-3">Coleman's bound</a></li>
</ul>
</li>
<li class="link"><a href="backmatter-1.html" data-scroll="backmatter-1"><span class="title">Back Matter</span></a></li>
<li class="link"><a href="references-1.html" data-scroll="references-1"><span class="title">References</span></a></li>
</ul></nav><div class="extras"><nav><a class="feedback-link" href="https://github.com/alexjbest/p-adic-methods/issues" target="_blank">Feedback</a><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="sec-chab-coleman"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">2</span> <span class="title">The Chabauty-Coleman method</span>
</h2>
<a href="sec-chab-coleman.html" class="permalink">¶</a><section class="subsection" id="subsec-triangles"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.1</span> <span class="title">A question about triangles</span>
</h3>
<a href="sec-chab-coleman.html#subsec-triangles" class="permalink">¶</a><p id="p-14">Does there exist a rational right triangle and  a rational isosceles triangle with with same perimeter and same area? (rational means all side lengths are rational)</p>
<p id="p-15">Suppose there does exist such a pair, then introducing parameters, \(k,t\) for the right triangle, and \(l,u\) for the isosceles we can rescale to</p>
<div class="displaymath">
\begin{equation*}
k,t,u \in \QQ
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
0 \lt t, u \lt 1,\, k \gt 0
\end{equation*}
</div>
<p>an equate areas and perimeters. Areas:</p>
<div class="displaymath">
\begin{equation*}
\frac 12(2kt)(k)(1-t^2) = \frac 12(4u)(1-u^2)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\implies k^2 t^2(1-t^2) = 2u (1-u^2)\text{.}
\end{equation*}
</div>
<p>Perimeters:</p>
<div class="displaymath">
\begin{equation*}
k(1-t^2) + k(1+t^2) + 2kt = 1 + u^2 + 1 + u^2 + 4u
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\implies k+ kt = 1 + 2u + u^2 = (1+u)^2
\end{equation*}
</div>
<p>so letting \(x=1 +u\text{,}\) after some algebra we have \(1 \lt x \lt 2\) in \(\QQ\) s.t.</p>
<div class="displaymath">
\begin{equation*}
2xk^2 + (-3x^3 -2x^2 + 6x - 4)k + x^5 = 0
\end{equation*}
</div>
<p>this is a quadratic in \(k\text{,}\) and the discriminant is a square in \(\QQ\text{.}\) so</p>
<div class="displaymath">
\begin{equation*}
X\colon  y^2 = (-3x^3 - 2x^2 + 6x - 4)^2 - 4(2x)x^5
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= x^{6} + 12 x^{5} - 32 x^{4} + 52 x^{2} - 48 x + 16
\end{equation*}
</div>
<p>so this is a genus 2 hyperelliptic curve. We need the \(\QQ\)-points of this.</p>
<article class="paragraphs" id="paragraphs-1"><h5 class="heading"><span class="title">Facts:.</span></h5>
<p id="p-16">\(\Jac(X)\)  has Mordell-Weil rank 1. The Chabauty-Coleman bound on the size of \(X(\QQ)\) for this curve gives \(\#X(\QQ) \le 10\text{.}\) But we find points</p>
<div class="displaymath">
\begin{gather*}
\left\{ \left(0 : -4 : 1\right), \infty_{\pm} , \left(0 : 4 : 1\right), \left(1 : -1 : 1\right), \left(1 : 1 : 1\right),\left(\frac{12}{11} : -\frac{868}{1331} : 1\right),\right.\\
\left. \left(\frac{12}{11} : \frac{868}{1331} : 1\right), \left(2 : -8 : 1\right), \left(2 : 8 : 1\right)\right\}
\end{gather*}
</div>
<p>so this set is \(X(\QQ)\text{.}\)</p></article><p id="p-17">Back in the original problem we specified \(x \lt 1 \lt 2\text{,}\) so there is a unique such pair of triangles:</p>
<article class="theorem-like" id="theorem-1"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.1</span>. <span class="title">Hirakawa-Matsumura '18.</span>
</h6>
<p id="p-18">Up to similitude there exists a unique pair of a rational right triangle and a rational isosceles triangle that have the same perimeters and areas. The unique pair consists of a right triangle with sides</p>
<div class="displaymath">
\begin{equation*}
(377, 135, 352)
\end{equation*}
</div>
<p>and the isosceles triangle with sides</p>
<div class="displaymath">
\begin{equation*}
(366, 366, 132)\text{.}
\end{equation*}
</div></article></section><section class="subsection" id="subsection-2"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.2</span> <span class="title">Why care about \(X(\QQ)\) for \(X\) of genus 2?</span>
</h3>
<p id="p-19">Curves of genus 0: have no \(\QQ\)-points or infinitely many, they satisfy a local to global principle so there exists an algorithm to determine the \(\QQ\)-points in finite time.</p>
<p id="p-20">Curves of genus 1: If we have 1 smooth rational point then we have an elliptic curve, Mordell's theorem implies that \(E(\QQ)\) is a finitely generated abelian group,</p>
<div class="displaymath">
\begin{equation*}
E(\QQ) \simeq \ZZ^r \oplus T
\end{equation*}
</div>
<p>where the possible torsion parts \(T\) have been determined by Mazur's theorem. To understand \(T\text{,}\) and the distribution of \(T\) there is work of Harron and Snowden, this often comes down to understanding rational points on \(X_1(N)\text{.}\)</p>
<p id="p-21">Upshot: to understand \(E(\QQ)\) we want to understand \(r\text{:}\)</p>
<p id="p-22">Q1: is there an algorithm to compute \(r\text{?}\)</p>
<p id="p-23">Q2: what values of                   \(r\) can occur?</p>
<p id="p-24">Q3: what is the distribution of      \(r\text{?}\)</p>
<p id="p-25">A1: \(n\)-descent, the obstacle is \(\Sha\text{,}\) proving finiteness, it is conjectured that \(r =  \ord_{s=1}L(E,s)\) (BSD).</p>
<p id="p-26">A2: record due to Noam Elkies an example of \(E\) with \(r \ge 28\text{.}\)</p>
<p id="p-27">A3: minimalist conjecture: 50% of all curves have rank 0, 50% rank 1.</p>
<article class="theorem-like" id="thm-bhargava-shankar"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.2</span>. <span class="title">Bhargava-Shankar.</span>
</h6>
<p id="p-28">The average rank is \(\lt 1\text{.}\)</p></article><p id="p-29">Baur Bektemirov, Barry Mazur, William Stein, and Mark Watkins, Average ranks of elliptic curves: tension between data and conjecture, Bull. Amer. Math. Soc. (N.S.) 44 (2007), no. 2, 233–254. MR 2009e:11107 gave average rank graphs, which kept increasing.</p>
<p id="p-30">Sarnak said there would “obviously be a turn around”.</p>
<p id="p-31">Jennifer S. Balakrishnan, Wei Ho, Nathan Kaplan, Simon Spicer, William Stein, and James Weigandt, Databases of elliptic curves ordered by height and distributions of Selmer groups and ranks, LMS J. Comput. Math. 19 (2016), supp. A, pp. 351-370. MR 3540965</p></section><section class="subsection" id="subsection-3"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.3</span> <span class="title">Coleman's bound</span>
</h3>
<aside class="aside-like" id="aside-2"><p id="p-32">Lecture 2 10/9/2019</p></aside><p id="p-33">Goal today: prove Coleman's refinement of Chabauty's theorem.</p>
<article class="theorem-like" id="theorem-3"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.3</span>. <span class="title">Coleman 1985.</span>
</h6>
<p id="p-34">Let \(X/\QQ\) be a curve of genus \(g \ge 2\text{.}\) Suppose the Mordell-Weil rank of \(J(\QQ)\) is less than \(g\text{.}\) Then if \(p \gt 2g\) is a good prime for \(X\) we have</p>
<div class="displaymath">
\begin{equation*}
\#X(\QQ) \le \#X_{\FF_p} (\FF_p) + 2g - 2\text{.}
\end{equation*}
</div></article><article class="definition-like" id="def-differentials"><h6 class="heading">
<span class="type">Definition</span> <span class="codenumber">2.4</span>. <span class="title">Differentials.</span>
</h6>
<p id="p-35">Let \(X\) be a  curve over a field \(k\text{.}\) The space of <dfn class="terminology">differentials</dfn> on \(X\) over \(k\) is a 1-dimensional \(k(X)\)-vector space \(\Omega ^1_X(k)\text{.}\)</p>
<p id="p-36">There is a nontrivial \(k\)-linear derivation</p>
<div class="displaymath">
\begin{equation*}
\diff \colon  k(X) \to \Omega ^1_X(k)
\end{equation*}
</div>
<p>i.e. \(\diff\) is \(k\)-linear and satisfies the Leibniz rule</p>
<div class="displaymath">
\begin{equation*}
\diff(fg) = g \diff f + f \cdot \diff g
\end{equation*}
</div>
<p>for all \(f,g\in k(X)\) and there is some \(f \in k(X)\) s.t. \(\diff f \ne 0\text{.}\)</p>
<p id="p-37">A general differential can be written as \(\omega  = f \diff g\) where \(g\in K(X)\) with \(\diff g \ne 0\text{.}\) If we fix \(g\) this representation is unique. If \(\omega ,\omega ' \in \Omega ^1_X(k)\) with \(\omega ' \ne0\) then there's a unique \(f\in K(X)\) s.t. \(\omega = f\omega '\text{.}\) We may write \(\omega /\omega ' = f\text{.}\)</p></article><article class="definition-like" id="def-differentials-first-second"><h6 class="heading">
<span class="type">Definition</span> <span class="codenumber">2.5</span>. <span class="title">Differentials of the first second and third kinds.</span>
</h6>
<p id="p-38">Let \(0\ne \omega  \in \Omega ^1_X(k)\) and \(P\in X(k)\text{.}\) Let \(t\in k(X)\) be  a uniformizer at \(P\text{.}\) Then \(v_P(\omega ) = v_P(\omega /\diff t)\) is the valuation of \(\omega \) at \(P\text{.}\) This valuation is nonzero for only finitely many points \(P \in X(\overline k)\text{.}\) The divisor</p>
<div class="displaymath">
\begin{equation*}
\divisor(\omega ) = \sum_{P\in X(\overline k)}v_P(\omega ) P \in \Div_X(k)
\end{equation*}
</div>
<p>is the divisor of \(\omega\text{.}\)</p>
<p id="p-39">If \(v_P(\omega )\ge\) then \(\omega \) is regular at \(P\) and \(\omega \) is said to be regular if it is regular at all points \(P\in X(\overline K)\text{.}\)</p>
<p id="p-40">Also called differentials of the <dfn class="terminology">first kind</dfn>.</p>
<p id="p-41">A differential of the <dfn class="terminology">second kind</dfn> has residue zero at all points \(P\in X(\overline K)\text{.}\)</p>
<p id="p-42">A differential of the <dfn class="terminology">third kind</dfn> has at most a simple pole at all points \(P\in X(\overline K)\) (and integer residues there in some references).</p></article><p id="p-43">Since the quotient of any two non-zero differentials is  a function</p>
<div class="displaymath">
\begin{equation*}
\omega_1 = f_1 \diff g
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\omega_2 = f_2 \diff g
\end{equation*}
</div>
<p>so</p>
<div class="displaymath">
\begin{equation*}
\frac{\omega _1}{\omega _2}  = \frac{f_1}{f_2}\text{.}
\end{equation*}
</div>
<p>The difference  of any two divisors of differentials is a principal divisor.</p>
<div class="displaymath">
\begin{equation*}
\divisor\left(\frac{\omega _1}{\omega _2}\right)  = \divisor \left(\frac{f_1}{f_2}\right)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \divisor \omega _1 - \divisor \omega _2\text{.}
\end{equation*}
</div>
<p id="p-44">So the divisors of differentials form one linear equivalence class of divisors, the canonical class.</p>
<article class="paragraphs" id="paragraphs-2"><h5 class="heading"><span class="title">Recall.</span></h5>
<p id="p-45">Let \(X/k\) be a curve and \(D\in \Div_X(k)\text{.}\) The Riemann-Roch space of \(D\) is the \(k\)-vector space</p>
<div class="displaymath">
\begin{equation*}
L(D) = \left\{\phi \in k(X)^\times : \divisor \phi  + D \ge 0\right\} \cup \{0\}
\end{equation*}
</div>
<p>where we write \(D \ge D'\) if \(v_P(D) \ge v_P(D')\) for all \(P\text{.}\)</p></article><article class="theorem-like" id="theorem-4"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.6</span>. <span class="title">Riemann-Roch.</span>
</h6>
<p id="p-46">Let \(X/k\) be a curve of genus \(g\) then there is a divisor \(W \in \Div_X(k)\) s.t. for every \(D\in \Div_X(k)\) w we have \(\dim_k L(D)\) is finite and</p>
<div class="displaymath">
\begin{equation*}
\dim_k L(D)  = \deg D - g +1 \dim_l L(W -D)\text{.}
\end{equation*}
</div>
<p id="p-47">In particular, \(\dim_k L(W) = g\text{,}\) \(\deg W = 2g-2\text{.}\)</p>
<p id="p-48">The canonical class is exactly the class of the divisor \(W\) in Riemann-Roch.</p>
<p id="p-49">The \(k\)-vector space of regular differentials has \(\dim L(W)  = g\text{,}\) and is denoted as \(H^0(X, \Omega ^1_X)\text{.}\)</p></article><article class="example-like" id="example-1"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.7</span>.</h6>
<p id="p-50">Let \(X\colon  y^2 = f(x)\) be a hyperelliptic curve of genus \(g\) over \(k\text{.}\) Then \(H^0(X, \Omega ^1_X)\) has basis</p>
<div class="displaymath">
\begin{equation*}
\left\{ \frac{\diff x}{2y}, \ldots, \frac{x^{g-1}\diff x}{2y} \right\}
\end{equation*}
</div>
<p>so every regular differential can be written uniquely as</p>
<div class="displaymath">
\begin{equation*}
\frac{p(x) \diff x}{2y}
\end{equation*}
</div>
<p>with a polynomial \(p\) of degree \(\le g-1\text{.}\)</p></article><p id="p-51">We want to integrate differentials in some \(p\)-adic sense, Q: What does a \(p\)-adic line integral look like?</p>
<article class="theorem-like" id="theorem-5"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.8</span>.</h6>
<p id="p-52">Let \(X/\QQ_p\) be a curve with good reduction then there is a \(p\)-adic integral</p>
<div class="displaymath">
\begin{equation*}
\int_P^Q \omega  \in \overline \QQ_p
\end{equation*}
</div>
<p>defined for each pair of points \(P,Q\in X(\overline \QQ_p)\) and regular differential \(\omega \in H^0(X, \Omega _X^1(\overline \QQ_p))\) that satisfies the following properties:</p>
<ol class="decimal">
<li id="li-27">The integral is \(\overline \QQ_p\) linear in \(\omega \)</li>
<li id="li-28">If \(P,Q\) both reduce to the same point \(\bar P \in X_{\FF_p}(\FF_p)\) then the integral can be evaluated by writing<div class="displaymath">
\begin{equation*}
\omega  = \omega (t) \diff t
\end{equation*}
</div>with \(t\) a uniformizer at \(P\) reducing to  a uniformizer at \(\bar P\) and \(\omega \) a power series. Then integrating formally  obtaining a power series \(l\) s.t.<div class="displaymath">
\begin{equation*}
\diff l(t) = w(t) \diff t
\end{equation*}
</div>and \(l(0) = 0\) and finally evaluating<div class="displaymath">
\begin{equation*}
l(t(Q))
\end{equation*}
</div>which converges. This implies that \(\int_P^P \omega  = 0\text{.}\)</li>
<li id="li-29">
<div class="displaymath">
\begin{equation*}
\int_P^Q \omega  + \int_{P'}^{Q'} \omega  =  \int_P^{Q'} \omega   + \int_{P'}^Q \omega 
\end{equation*}
</div>so it makes sense to define:<div class="displaymath">
\begin{equation*}
\int_D \omega
\end{equation*}
</div>for<div class="displaymath">
\begin{equation*}
\sum_{j=1}^n Q_j  - P_j \in \Div^0_X(\overline \QQ_p)
\end{equation*}
</div>as<div class="displaymath">
\begin{equation*}
\int_D \omega  = \sum_{j=1}^n \int_{P_j}^{Q_j} \omega 
\end{equation*}
</div>
</li>
<li id="li-30">If \(D\) is principal then \(\int_D \omega  = 0\text{.}\)</li>
<li id="li-31">The integral commutes with the action of \(\absgal{\QQ_p}\text{.}\)</li>
<li id="li-32">Fix \(P_0 \in X(\overline \QQ_p)\text{.}\) If \(0\ne \omega  \in H^0(X, \Omega ^1_X)\text{,}\) then the set of points \(P \in X(\overline \QQ_p)\) reducing to a fixed point \(P_0 \in X_{\FF_p}(\overline \FF_p)\text{.}\) and s.t.<div class="displaymath">
\begin{equation*}
\int_{P_0}^P \omega  = 0
\end{equation*}
</div>is finite.</li>
</ol></article><article class="remark-like" id="remark-1"><h6 class="heading">
<span class="type">Remark</span> <span class="codenumber">2.9</span>.</h6>
<p id="p-53">The statement that the curve has good reduction is not necessary but simplifies the statement of 2.</p></article><article class="remark-like" id="remark-2"><h6 class="heading">
<span class="type">Remark</span> <span class="codenumber">2.10</span>.</h6>
<p id="p-54">This    integral is the Coleman integral <a data-knowl="./knowl/bib-coleman-torsion.html" title="Bibliographic Entry 30: Torsion points on curves and p-adic abelian integrals.">[30]</a>, other works on \(p\)-adic integration include Berkovich <a data-knowl="./knowl/bib-berkovich.html" title="Bibliographic Entry 12: Integration of One-forms on P-adic Analytic Spaces">[12]</a>. Also there is work of Zarhin, Colmez, Vologodsky, Besser, ...</p></article><article class="remark-like" id="remark-3"><h6 class="heading">
<span class="type">Remark</span> <span class="codenumber">2.11</span>.</h6>
<p id="p-55">Theory of Coleman integration of forms the second or third kind developed by Coleman-de Shalit <a data-knowl="./knowl/bib-coleman-de-shalit.html" title="Bibliographic Entry 32: \(p\)-adic regulators on curves and special values of \(p\)-adic \(L\)-functions">[32]</a>. (additivity in endpoints, linearity, change of variables, FTC).</p></article><article class="theorem-like" id="corollary-1"><h6 class="heading">
<span class="type">Corollary</span> <span class="codenumber">2.12</span>.</h6>
<p id="p-56">Given the hypotheses of the previous theorem</p>
<div class="displaymath">
\begin{equation*}
P_0 \in X(\QQ_p)
\end{equation*}
</div>
<p>and \(J\) the Jacobian of \(X\) let</p>
<div class="displaymath">
\begin{equation*}
\iota  \colon X \to J
\end{equation*}
</div>
<p>be the embedding</p>
<div class="displaymath">
\begin{equation*}
P \mapsto [P - P_0]
\end{equation*}
</div>
<p>there is a map</p>
<div class="displaymath">
\begin{equation*}
J(\QQ_p) \times H^0(X, \Omega _X^1) \to \QQ_p
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
(P,\omega ) \mapsto \pair P \omega 
\end{equation*}
</div>
<p>that is additive in \(P\) and \(\QQ_p\) linear in \(\omega \) which is given by</p>
<div class="displaymath">
\begin{equation*}
\pair{[D]}\omega  = \int_D \omega 
\end{equation*}
</div>
<p>in particular for</p>
<div class="displaymath">
\begin{equation*}
P\in X(\QQ_p)
\end{equation*}
</div>
<p>we have</p>
<div class="displaymath">
\begin{equation*}
\pair{\iota (P)}\omega  = \int_{P_0}^P \omega \text{.}
\end{equation*}
</div></article><article class="remark-like" id="remark-4"><h6 class="heading">
<span class="type">Remark</span> <span class="codenumber">2.13</span>.</h6>
<p id="p-57">If \(P \in J(\QQ_p)\) has finite order, then</p>
<div class="displaymath">
\begin{equation*}
\pair P\omega =0,\,\forall \omega \in H^0(X, \Omega _X^1)
\end{equation*}
</div>
<p>to see this, if \(nP= 0\) then</p>
<div class="displaymath">
\begin{equation*}
\pair P\omega  = \frac1n\pair{nP}\omega  = \frac1n0 = 0\text{.}
\end{equation*}
</div>
<p>One can show that torsion points are the only points with this property. On the other hand, if \(\omega \) has the property that  \(\pair P\omega  = 0\) for all \(P \in J(\QQ_p)\) then \(\omega =0\text{.}\)</p></article><article class="theorem-like" id="corollary-2"><h6 class="heading">
<span class="type">Corollary</span> <span class="codenumber">2.14</span>.</h6>
<p id="p-58">Let \(X/\QQ\) be a curve of genus \(g\) with Mordell-Weil rank less than \(g\text{.}\) Then \(\# X(\QQ)\) is finite. Note we don't need \(g \ge 2\text{,}\) in \(g=1\) this applies to rank 0.</p></article><article class="hiddenproof" id="proof-1"><a data-knowl="" class="id-ref" data-refid="hk-proof-1"><h6 class="heading"><span class="type">Proof.</span></h6></a></article><div id="hk-proof-1" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><p id="p-59">Pick a prime of good reduction for \(X\) let</p>
<div class="displaymath">
\begin{equation*}
V = \{ \omega  \in H^0(X, \Omega _X^1) : \forall P \in J(\QQ) : \pair P\omega  = 0\}
\end{equation*}
</div>
<p>by additivity in the first argument this condition is equivalent to requiring that \(\pair{P_j}\omega  = 0\) for a basis \(\{P_j\}_{j=1}^r\) of the free part of \(J(\QQ)\) so it leads to at most \(r\) linear constraints, so \(\dim V \ge g - r \gt 0\text{.}\) So there is some \(0 \ne \omega  \in V\) pick \(P_0 \in X(\QQ)\text{,}\) if \(X(\QQ) = \emptyset\) we are done. To define \(\iota \colon X \hookrightarrow J\text{.}\) Since \(\iota (P) \in J(\QQ)\) for all \(P\in X(\QQ)\) so it follows that \(\int_{P_0}^P\omega =0\) for all \(P\in X(\QQ)\text{.}\) By the theorem the number of such \(P\) is finite in each residue disk of \(X(\QQ)\text{.}\) Since the number of residue classes is  \(\# X(\FF_p)\) which is finite. The total number of points in \(X(\QQ)\) is finite also.</p>
<p id="p-60">To get an actual bound we have to bound the number of zeroes of</p>
<div class="displaymath">
\begin{equation*}
\int_{P_0}^z \omega 
\end{equation*}
</div>
<p>as a \(p\)-adic power series. We can think of \(X(\QQ_p)\) set theoretically as a finite union of residue disks. Within each residue disk</p>
<div class="displaymath">
\begin{equation*}
\int_{P_0}^z \omega 
\end{equation*}
</div>
<p>has finitely many \(p\)-adic zeroes.</p></article></div>
<aside class="aside-like" id="aside-3"><p id="p-61">Lecture 3 10/9/2019</p></aside><p id="p-62">We want  to give  a more refined version of this result which uses results about zeroes of \(p\)-adic power series.</p>
<article class="theorem-like" id="theorem-6"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.15</span>.</h6>
<p id="p-63">Let</p>
<div class="displaymath">
\begin{equation*}
0 \ne l(t) = \sum_{n=0}^\infty a_nt^n\in \QQ_p[[t]]
\end{equation*}
</div>
<p>such that \(a_n \to 0\) as \(n \to \infty \) in the \(p\)-adic topology. Let</p>
<div class="displaymath">
\begin{equation*}
v_0 = \min\{ v_p(a_n) : n \ge 0 \}
\end{equation*}
</div>
<p>and</p>
<div class="displaymath">
\begin{equation*}
N = \max\{ n \ge 0, v_p (a_n) = v_0\}
\end{equation*}
</div>
<p>then there is a constant</p>
<div class="displaymath">
\begin{equation*}
c \in \QQ_p^\times
\end{equation*}
</div>
<p>a monic polynomial</p>
<div class="displaymath">
\begin{equation*}
q \in \ZZ_p[t]
\end{equation*}
</div>
<p>of degree \(N\text{,}\) a power series</p>
<div class="displaymath">
\begin{equation*}
h(t) = \sum_{n = 0}^\infty  b_n t^n \in 1+  pt \ZZ_p[[t]]
\end{equation*}
</div>
<p>with</p>
<div class="displaymath">
\begin{equation*}
b_n \to 0 \text{ as } n \to \infty 
\end{equation*}
</div>
<p>and</p>
<div class="displaymath">
\begin{equation*}
l(t) = cq(t)h(t)\text{.}
\end{equation*}
</div></article><article class="hiddenproof" id="proof-2"><a data-knowl="" class="id-ref" data-refid="hk-proof-2"><h6 class="heading"><span class="type">Proof.</span></h6></a></article><div id="hk-proof-2" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><p id="p-64">After rescaling by \(a_0\inv\) can assume \(v_0 = 0\) and \(a_N = 1\) so this in particular \(l(t) \in \ZZ_p\lb \lb t\rb \rb \) the condition \(a_n \to 0\) means that the image \(l_m(t)\) of \(l(t)\) in \(\ZZ/p^m\ZZ[[t\)]] is actually a polynomial for all \(m \ge1\text{.}\)</p>
<p id="p-65">The idea is to construct inductively constants \(c_m \in (\ZZ/p^m)^\times\text{,}\) monic polynomials \(q_m(t) \in (\ZZ/p^m)\lb t\rb \) of degree \(N\) and polynomials \(h_m(t) \in (\ZZ/p^m)\lb t\rb \) with \(h_m \equiv 1 \pmod{pt}\) satisfying</p>
<div class="displaymath">
\begin{equation*}
l_m(t) = c_m q_m(t) h_m(t)
\end{equation*}
</div>
<p>and such that</p>
<div class="displaymath">
\begin{equation*}
(c_{m+1}, q_{m+1}, h_{m+1})
\end{equation*}
</div>
<p>reduces \(\pmod{p^m}\) to</p>
<div class="displaymath">
\begin{equation*}
(c_{m}, q_{m}, h_{m})\text{.}
\end{equation*}
</div>
<p id="p-66">Then there is a unique \(c, q, h\) as above such that</p>
<div class="displaymath">
\begin{equation*}
(c, q, h)
\end{equation*}
</div>
<p>reduces \(\pmod{p^m}\) to</p>
<div class="displaymath">
\begin{equation*}
(c_{m}, q_{m}, h_{m})
\end{equation*}
</div>
<p>for all \(m\text{.}\)</p>
<p id="p-67">To start the  induction set \(c_1 = 1\)</p>
<div class="displaymath">
\begin{equation*}
q_1 (t) = l_1(t)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
h_1(t) = 1
\end{equation*}
</div>
<p>this is possible since \(l_1(t)\) is monic of degree \(N\text{.}\)</p>
<p id="p-68">Assume we've constructed \(c_m,q_m,h_m\text{,}\) let</p>
<div class="displaymath">
\begin{equation*}
\tilde c_{m+1}, \tilde q_{m+1}, \tilde h_{m+1}
\end{equation*}
</div>
<p>be arbitrary lifts of \(c_m,q_m,h_m\) to objects  over \(\ZZ/p^{m+1}\) with</p>
<div class="displaymath">
\begin{equation*}
\tilde q_{m+1} \text{ monic of degree } N
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\tilde h_{m+1}(t) \equiv 1 \pmod{pt}
\end{equation*}
</div>
<p>then</p>
<div class="displaymath">
\begin{equation*}
l_{m+1}(t) - \tilde c_{m+1} \tilde q_{m+1} \tilde h_{m+1} = p^m d(t)
\end{equation*}
</div>
<p>with</p>
<div class="displaymath">
\begin{equation*}
d(t) \in (\ZZ/p)[t]
\end{equation*}
</div>
<p>then we must have</p>
<div class="displaymath">
\begin{equation*}
c_{m+1} = \tilde c_{m+1} + p^m \gamma 
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
q_{m+1} = \tilde q_{m+1} + p^m k(t)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
h_{m+1} = \tilde h_{m+1} + p^m \eta(t)
\end{equation*}
</div>
<p>with \(\gamma \in \ZZ/p\text{,}\) \(k\in (\ZZ/p)\lb t\rb \) of degree \(\lt N\text{.}\) and \(\eta \in (\ZZ/p)\lb  t\rb \) with \(\eta(0) = 0\text{.}\)</p>
<p id="p-69">For \(\gamma \in \ZZ /p \ZZ\text{,}\) \(k(t) \in  (\ZZ /p \ZZ) \lb  t\rb \) of degree less than \(N\text{,}\) and \(\eta(t) \in  (\ZZ /p \ZZ) \lb t\rb \) with \(\eta (0) = 0\text{.}\) So the relation \(l_{ m+1} (t) = c_{ m+1} q_{ m+1} (t)h_{m+1 }(t)\) is equivalent to \(d(t) = (\gamma  +  \eta(t)) l_1 (t) + k(t)\text{,}\) and \(\gamma , k(t)\text{,}\) and \(\eta(t)\) are uniquely determined through division by \(l_1 (t)\) with remainder \(d(t)\text{,}\) and this determines \(c_{m+1} ,\, q_{ m+1} (t)\) , and \(h_{m+1} (t)\text{.}\)</p></article></div>
<p id="p-70">Now we apply this to study zeroes of \(p\)-adic power series coming from Coleman integrals.</p>
<article class="theorem-like" id="lemma-1"><h6 class="heading">
<span class="type">Lemma</span> <span class="codenumber">2.16</span>.</h6>
<p id="p-71">Let \(l(t) \in \QQ_p\lb \lb t\rb \rb \) with formal derivative \(w(t) \in \ZZ_p\lb \lb t\rb \rb \text{.}\) Such that the image \(\bar w (t) \in \FF_p \lb \lb t\rb \rb \) has the form \(ut^\nu + \cdots\) with \(u \in\FF_p\units\text{.}\) Then \(l\) converges on \(p \ZZ_p\text{.}\) If \(p \gt \nu + 2\) then</p>
<div class="displaymath">
\begin{equation*}
\#\{\tau  \in p\ZZ_p : l(t) = 0 \} \le \nu + 1\text{.}
\end{equation*}
</div></article><article class="hiddenproof" id="proof-3"><a data-knowl="" class="id-ref" data-refid="hk-proof-3"><h6 class="heading"><span class="type">Proof.</span></h6></a></article><div id="hk-proof-3" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><p id="p-72">Let</p>
<div class="displaymath">
\begin{equation*}
w(t) = w_0 + w_1t + \cdots
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
l(t) = l_0 + l_1t + \cdots
\end{equation*}
</div>
<p>then</p>
<div class="displaymath">
\begin{equation*}
l_{n+1}  = \frac{w_n}{n+1} \in \frac{1}{n+1}\ZZ_p
\end{equation*}
</div>
<p>since \(v_p(n+1) = O(\log n)\) the assumption that</p>
<div class="displaymath">
\begin{equation*}
w_n \in \ZZ_p
\end{equation*}
</div>
<p>implies that \(v_p(l_n) = v_p(w_n/(n+1))\ge - c\log n\) for some constant \(c\text{.}\) If \(\tau  \in p \ZZ_p\) so \(v_p(\tau ) \ge 1\text{,}\) then</p>
<div class="displaymath">
\begin{equation*}
v_p(l_n\tau ^n) \ge n - c\log n  \to \infty 
\end{equation*}
</div>
<p>as \(n \to \infty \text{,}\) hence \(l(\tau )\) converges. Now consider \(l(pt) = l_0 + pl_1t + p^2 l_2 t^2 + \cdots\text{.}\) The claim is that in the notation of the previous theorem we have \(N \le \nu +1\text{.}\)</p>
<div class="displaymath">
\begin{equation*}
v_p(p^{\nu  + 1} l_{\nu +1}) = \nu  + 1 + v_p(l_{\nu +1})
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \nu +1 + v_p\left(\frac{w_\nu }{\nu +1}\right)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \nu  + 1+  v_p(w_\nu ) - v_p(\nu  + 1) \le \nu  + 1
\end{equation*}
</div>
<p>as by assumption \(\bar w(t) \in \FF_p\lb \lb t\rb \rb \) has the form \(ut^\nu +\cdots\) so that \(v_p(w_\nu ) =0\text{.}\)</p>
<p id="p-73">For \(n \gt \nu \) we have</p>
<div class="displaymath">
\begin{equation*}
v_p(p^{n+1} l_{n+1}) = n+1 + v_p(l_{n+1})
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= n + 1+ v_p(w_n) - v_p(n+1)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\ge n+1 - v_p(n+1)
\end{equation*}
</div>
<p>since</p>
<div class="displaymath">
\begin{equation*}
v_p(w_n) \ge 0
\end{equation*}
</div>
<p>for \(n \gt \nu \text{.}\) So it suffices to show that</p>
<div class="displaymath">
\begin{equation*}
n -  v_p(n+1) \gt \nu 
\end{equation*}
</div>
<p>This is clear for \(v_p(n+1) = 0\text{.}\) Otherwise suppose \(e = v_p(n+1)\) then \(p^e|(n+1)\text{.}\) So \(n+1 \ge p^3 \gt \nu + e+ 1\text{,}\) where the second inequality can be shown by induction. For \(e = 1\) this is our hypothesis that \(p \gt \nu  + 2\text{,}\) then use \(p^{e+1}\ge p^e + 1\text{.}\) The previous corollary now gives the result.</p></article></div>
<article class="theorem-like" id="theorem-7"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.17</span>. <span class="title">Coleman '85.</span>
</h6>
<p id="p-74">Let \(X/\QQ\) be a curve of genus \(g\text{,}\) with Mordell-Weil rank of \(J\) less than \(g\text{.}\) Then</p>
<div class="displaymath">
\begin{equation*}
\#X(\QQ) \le \#X(\FF_p) + 2g - 2\text{.}
\end{equation*}
</div>
<p><a data-knowl="./knowl/bib-coleman-chabauty.html" title="Bibliographic Entry 31: Effective Chabauty">[31]</a>.</p></article><article class="hiddenproof" id="proof-4"><a data-knowl="" class="id-ref" data-refid="hk-proof-4"><h6 class="heading"><span class="type">Proof.</span></h6></a></article><div id="hk-proof-4" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><p id="p-75">We assume \(P_0\in X(\QQ)\text{,}\) now arguing as in the proof of today's first corollary there is a non-zero differential \(\omega  \in H^0(X, \Omega ^1_{X/\QQ_p})\) such that</p>
<div class="displaymath">
\begin{equation*}
\int_{P_0}^P \omega  = 0
\end{equation*}
</div>
<p>for all \(P\in X(\QQ)\text{.}\) Now consider a point \(\bar Q \in \overline X(\FF_p)\) and lift it to \(Q\) in \(X(\QQ_p)\text{,}\) we can pick a  uniformizer \(t\in \QQ_p(X)\units\) s.t at \(Q\) \(t\) reduces to a uniformizer \(\bar t \in \FF_p(\overline X)\units \) at \(\bar Q\text{.}\) We rescale \(\omega \) s.t. its reduction \(\bar \omega \) is defined an non-zero. Then \(\bar \omega  \in H^0(X, \Omega ^1_{X/\FF_p})\text{.}\) Recall that \(\divisor(\bar \omega)\) is effective and has degree \(2g-2\text{.}\) Let \(\nu (\bar Q)\) denote the valuation at \(\bar Q\) of \(\bar \omega \text{.}\) \(\nu (\bar Q) = \nu _{\bar Q}(\bar \omega )\text{.}\) We write \(\omega (t) = w(t) \diff t\) with</p>
<div class="displaymath">
\begin{equation*}
w(t) \in \ZZ_p[[t]]
\end{equation*}
</div>
<p>the coefficients are in \(\ZZ_p\) since \(\bar \omega \) is defined. Then</p>
<div class="displaymath">
\begin{equation*}
\bar \omega  = \bar w(t) \diff \bar t
\end{equation*}
</div>
<p>\(\bar w(\bar t) = \bar t^{\nu (\bar Q)}(u_0 + u_1 \bar t + \cdots)\text{.}\)</p>
<div class="displaymath" id="p-76">
\begin{equation*}
\int_{P_0}^P \omega  =l(t(P))
\end{equation*}
</div>
<p>for \(P \in X(\QQ_p)\) such that \(\bar p = \bar q\) and apply previous lemma. Now summing over residue disks we get</p>
<div class="displaymath">
\begin{equation*}
\#X(\QQ) \le \#\left\{ P\in X(\QQ_p) : \int_{P_0}^P \omega =0\right\}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\le \sum_{\bar Q \in \bar X(\FF_p)} \left(\nu (\bar Q)  + 1\right)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
=\sum_{\bar Q \in \bar X(\FF_p)} \nu (\bar Q)  + \sum_{\bar Q \in \bar X(\FF_p)}1
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\le \deg(\divisor \omega ) + \# \bar X(\FF_p)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= 2g - 2 + \# \bar X(\FF_p)\text{.}
\end{equation*}
</div></article></div>
<article class="remark-like" id="remark-5"><h6 class="heading">
<span class="type">Remark</span> <span class="codenumber">2.18</span>.</h6>
<p id="p-77">Stoll (06) showed that we can choose the best \(\omega \) in each residue disk, can improve the bound, \(r \lt g\) and \(p \gt 2r + 2\) is a good prime then</p>
<div class="displaymath">
\begin{equation*}
\#X(\QQ) \le \#\overline X(\FF_p) + 2r
\end{equation*}
</div>
<p>can also weaken the assumption that</p>
<div class="displaymath">
\begin{equation*}
p \gt  2r + 2\text{.}
\end{equation*}
</div>
<p>If \(p \gt 2\) then</p>
<div class="displaymath">
\begin{equation*}
\# X(\QQ) \le \# \overline X(\FF_p) + 2r + \floor*{\frac{2r}{p-1}}\text{.}
\end{equation*}
</div>
<p><a data-knowl="./knowl/bib-stoll-independence.html" title="Bibliographic Entry 85: Independence of Rational Points on Twists of a given Curve">[85]</a>. Katz-Rabinoff-Zuerieck-Brown (12) extend Stoll's result tot the case of bad reduction, if \(p \gt 2g\) and \(\mathcal X\) a proper regular model for \(X\) over \(\ZZ_p\) then</p>
<div class="displaymath">
\begin{equation*}
\#X(\QQ) \le \#\mathcal X_{sm}(\FF_p) + 2r
\end{equation*}
</div>
<p>where \(\overline {\mathcal X}(\FF_p)\) is the set of smooth points in the special fiber of minimal proper regular model of \(X\) over \(\ZZ_p\text{.}\) <a data-knowl="./knowl/bib-katz-zureick-clifford.html" title="Bibliographic Entry 56: The Chabauty–Coleman Bound at a Prime of Bad Reduction and Clifford Bounds for Geometric Rank Functions">[56]</a>.</p></article><aside class="aside-like" id="aside-4"><p id="p-78">Lecture 4 17/9/2019</p></aside><p id="p-79">A few results applying Chabauty-Coleman to prove uniform bounds:</p>
<article class="theorem-like" id="theorem-8"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.19</span>. <span class="title">Stoll '13.</span>
</h6>
<p id="p-80">If \(X/\QQ\) is hyperelliptic of genus \(g\) with Jacobian of Mordell-Weil rank \(r \le g -3\text{,}\) then</p>
<div class="displaymath">
\begin{equation*}
\#X(\QQ) \le 8rg + 33(g-1) + 1
\end{equation*}
</div>
<p><a data-knowl="./knowl/bib-stoll-uniform.html" title="Bibliographic Entry 86: Uniform Bounds for the Number of Rational Points on Hyperelliptic Curves of Small Mordell–Weil Rank">[86]</a>.</p></article><article class="theorem-like" id="theorem-9"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.20</span>. <span class="title">Katz-Rabinoff-Zuerieck-Brown '19.</span>
</h6>
<p id="p-81">If \(X/\QQ\) curves of genus \(g\) with \(r\le g-3\text{.}\)</p>
<div class="displaymath">
\begin{equation*}
\#X(\QQ) \le 84 g^2 - 98 g + 28\text{.}
\end{equation*}
</div>
<p>Ref KRZB and expository paper.</p></article><p id="p-82">Suppose \(X/\QQ\) is genus 3, hyperelliptic curve of rank 0, Stoll's bound gives \(\#X(\QQ) \le 67\text{.}\) Is there a curve meeting this bound? Or even \(\#X(\QQ) =10\text{?}\)</p>
<p id="p-83">In the LMFDB we find in \(g=2\text{,}\) \(r=0\) the record seems to be \(\#X(\QQ) = 8\text{.}\) For <a class="external" href="http://lmfdb.org/Genus2Curve/Q/1116.a.214272.1" target="_blank"><code class="code-inline tex2jax_ignore">http://lmfdb.org/Genus2Curve/Q/1116.a.214272.1</code></a> we have \(\#X(\QQ) = 8\text{.}\)</p>
<div class="displaymath">
\begin{equation*}
J(\QQ) \simeq \ZZ/39
\end{equation*}
</div>
<p>with simple Jacobian (first found by Elkies).</p>
<p id="p-84">It is possible to use constructions of Howe, Leprevost, Poonen, Elkies, others to construct Jacobians with even larger torsion (and possibly curves of low rank with many rational points? Earlier we talked about computing annihilating differentials in the Chabauty-Coleman method. Here is a concrete example, to motivate a discussion of explicit Coleman integration.</p>
<article class="example-like" id="example-2"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.21</span>.</h6>
<p id="p-85">Consider</p>
<div class="displaymath">
\begin{equation*}
X\colon y^2 = x^5 - 4x^3 + 3x + 1
\end{equation*}
</div>
<p><a class="external" href="http://lmfdb.org/Genus2Curve/Q/3920.b.62720.1" target="_blank"><code class="code-inline tex2jax_ignore">http://lmfdb.org/Genus2Curve/Q/3920.b.62720.1</code></a>.</p>
<div class="displaymath">
\begin{equation*}
J(\QQ) \simeq \ZZ\oplus \ZZ/2\text{.}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
N = 3920 = 2^4 \cdot 5 \cdot 7^2\text{.}
\end{equation*}
</div>
<p>And</p>
<div class="displaymath">
\begin{equation*}
X(\QQ) \supseteq\{\infty , (0,\pm1), (1,\pm1), (-1,\pm 1)\}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\#X_{\FF_{11}}(\FF_{11}) = 13
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\#X_{\FF_{13}}(\FF_{13}) = 14
\end{equation*}
</div>
<p>so the Chabauty-Coleman bound by itself does not prove that we found all the \(\QQ\)-points already. The point</p>
<div class="displaymath">
\begin{equation*}
\lb (1,1) - \infty \rb 
\end{equation*}
</div>
<p>is of infinite order in \(J(\QQ)\text{.}\) We use it to construct an annihilating differential. Let \(p = 11\text{.}\) Then a basis of \(H^0(X,\Omega ^1)\) is given by</p>
<div class="displaymath">
\begin{equation*}
\left\{ \omega _i = \frac{x^i \diff x}{2y}\right\}_{i=0,1}
\end{equation*}
</div>
<p>so the annihilating differential \(\eta\) is some  \(\QQ_p\)-linear combination of \(\omega _0,\omega _1\text{.}\) We use the values of</p>
<div class="displaymath">
\begin{equation*}
\int_\infty ^{(1,1)} \omega _0,\, \int_\infty ^{(1,1)} \omega _1
\end{equation*}
</div>
<p>to compute \(\eta\text{.}\) We find</p>
<div class="displaymath">
\begin{equation*}
\int_\infty ^{(1,1)} \omega _0 = 8\cdot 11 + 7 \cdot 11^2 + 7\cdot 11^3 + 4\cdot 11^7 + 9\cdot 11^8 + O(11^9)   = \alpha 
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\int_\infty ^{(1,1)} \omega _1 = 3\cdot 11 + 2\cdot 11^2 + 4\cdot 11^3 +  3  \cdot 11^4 + 6\cdot 11^5 + 6\cdot 11^6 + 8\cdot 11^7 + 3\cdot 11^8 + O(11^9)   = \beta \text{.}
\end{equation*}
</div>
<p>Then</p>
<div class="displaymath">
\begin{equation*}
\int_{\infty }^{(1,1)} \beta  \omega _0 - \alpha \omega _1 =  0
\end{equation*}
</div>
<p>so take</p>
<div class="displaymath">
\begin{equation*}
\eta                  =\beta  \omega _0 - \alpha \omega _1\text{.}
\end{equation*}
</div>
<p>To use \(\eta\) to compute \(X(\QQ)\) or more precisely, a finite subset of \(X(\QQ_p)\) containing \(X(\QQ)\) we need to compute the collection of indefinite Coleman integrals</p>
<div class="displaymath">
\begin{equation*}
\left\{\int_\infty ^{P_t} \eta\right\}
\end{equation*}
</div>
<p>where \(P_t\) ranges over all residue disks. And solve for \(z\in X(\QQ_p)\) such that</p>
<div class="displaymath">
\begin{equation*}
\int_\infty ^z \eta = 0\text{.}
\end{equation*}
</div>
<p>So to compute \(\alpha ,\beta \) and the functions we needed Coleman integrals between points not in the same residue disk.</p></article><p id="p-86">Goal: show how to compute these \(p\)-adic integrals.</p>
<p id="p-87">Let \(X/\QQ\) be a curve. Let \(X^{an}\) be the associated rigid analytic space. (Let \(\mathcal X\) be a smooth curve over \(\ZZ_p\) s.t.</p>
<div class="displaymath">
\begin{equation*}
\mathcal X \otimes \QQ_p \simeq X\otimes \QQ_p\text{,}
\end{equation*}
</div>
<p>then \(X^{an}\) denotes the rigid analytic space over \(\QQ_p\) which is the generic fibre of \(\mathcal X\text{.}\))</p>
<article class="definition-like" id="definition-3"><h6 class="heading">
<span class="type">Definition</span> <span class="codenumber">2.22</span>.</h6>
<p id="p-88">A wide open subspace of \(X^{an}\) is the complement in \(X^{an}\) of the union of a finite collection of disjoint closed disks of radius \(\lambda _i \lt 1\text{.}\)</p></article><article class="example-like" id="example-3"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.23</span>.</h6>
<p id="p-89">Let</p>
<div class="displaymath">
\begin{equation*}
X\colon  y^2 = \prod_{i=1}^5 (x-\alpha _i)
\end{equation*}
</div>
<p>take out closed disks of radius \(\lambda _i\) for each \(P_i = (\alpha _i ,0)\) and \(\infty \text{.}\)</p></article><article class="theorem-like" id="theorem-10"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.24</span>. <span class="title">Coleman, Coleman-de Shalit.</span>
</h6>
<p id="p-90">Let \(\eta, \xi\) be 1-forms on a wide open \(V\) of \(X^{an}\) and \(P,Q,R \in V(\QQ_p)\text{.}\) Let \(a,b\in \QQ_p\text{.}\) The definite Coleman integral has the following properties</p>
<ol class="decimal">
<li id="li-33">Linearity<div class="displaymath">
\begin{equation*}
\int_{P}^Q \alpha  \eta + b \xi = \alpha \int_P^Q \eta + b \int_P^Q \xi
\end{equation*}
</div>
</li>
<li id="li-34">Additivity in endpoints<div class="displaymath">
\begin{equation*}
\int_P^Q \eta = \int_P^R \eta + \int_R^Q \eta
\end{equation*}
</div>
</li>
<li id="li-35">Change of variables, if \(V' \subseteq X'\) is a wide open subspace of a rigid analytic space \(X'\) and \(\phi  \colon V \to V'\) is a rigid analytic map then<div class="displaymath">
\begin{equation*}
\int_P^Q \phi ^* \eta = \int_{\phi P}^{\phi Q} \eta\text{.}
\end{equation*}
</div>
</li>
<li id="li-36">Fundamental theorem of calculus<div class="displaymath">
\begin{equation*}
\int_P^Q \diff f = f(Q) - f(P)
\end{equation*}
</div>for \(f\) a rigid analytic function on \(V\text{.}\)</li>
</ol></article><p id="p-91">Goal: want to integrate</p>
<div class="displaymath">
\begin{equation*}
\int_P^Q \omega 
\end{equation*}
</div>
<p>for a 1-form of the second kind, \(P,Q \in V(\QQ_p)\text{.}\) Idea</p>
<ol class="decimal">
<li id="li-37">Take \(\phi \) to be a lift of frobenius from the special fibre.</li>
<li id="li-38">Write a basis \(\{\omega _i\}\) of 1-forms of the second kind.</li>
<li id="li-39">Compute \(\phi ^*\omega _i\) and use properties of Coleman integral to relate \(\int_P^Q \phi ^*\omega _i\) to \(\int_P^Q \omega _i\) and other terms we can compute.</li>
</ol>
<p id="p-92"><a data-knowl="./knowl/bib-kedlaya-counting.html" title="Bibliographic Entry 57: Counting points on hyperelliptic curves using Monsky-Washnitzer cohomology">[57]</a>, <a data-knowl="./knowl/bib-edixhoven-after.html" title="Bibliographic Entry 35: Point Counting after Kedlaya, EIDMA-Stieltjes Graduate Course, Leiden, September 22–26, 2003">[35]</a>, also Stephanie Chan MMath thesis (is this online?)</p>
<p id="p-93">Setup \(p\ne 2\) prime</p>
<div class="displaymath">
\begin{equation*}
\overline X/\FF_q,\,q=p^n
\end{equation*}
</div>
<p>hyperelliptic of genus \(g\) with affine equation</p>
<div class="displaymath">
\begin{equation*}
y^2 = P(x)
\end{equation*}
</div>
<p>with \(P(x)\) monic degree \(2g+1\text{,}\) with no repeated roots.</p>
<div class="displaymath">
\begin{equation*}
X \colon \overline X \smallsetminus \{ \infty , y=0\}\text{.}
\end{equation*}
</div>
<p>\(W\) ring of Witt vectors over \(\FF_q\text{,}\) (the unique unramified extension of \(\ZZ_p\) with residue field \(\FF_q\text{.}\)</p>
<p id="p-94">Choose a lift \(\tilde P\) of \(P\text{,}\) to a monic polynomial of degree \(2g+1\text{.}\) Over \(W\) this gives a  lift \(\widetilde X\) of \(X\text{.}\) Let \(A = W\lb  x,y,y\inv\rb /(y^2 - \tilde P(x))\) Let \(A^\dagger\) be the weak completion of \(A\text{,}\) explicitly let \(v_p\) denote the \(p\)-adic valuation on \(W\) extend it to polynomials. If \(g(x) = \sum a_i x^i\text{,}\) define \(v_p(g) = \min\{v_p(a_i)\}\text{.}\) The elements of \(A^\dagger\) are series</p>
<div class="displaymath">
\begin{equation*}
\sum_{-\infty }^\infty  ( S_n(x) + T_n(x)y)y^{2n}
\end{equation*}
</div>
<p>where \(S_n\) and \(T_n\) are polynomials of degree at most \(2g\) s.t. limits are positive.</p>
<aside class="aside-like" id="aside-5"><p id="p-95">Lecture 5 19/9/2019</p></aside><p id="p-96">References for Rigid Geometry: <a data-knowl="./knowl/bib-fresnel-van-der-put.html" title="Bibliographic Entry 36: Rigid analytic geometry and its applications">[36]</a> <a data-knowl="./knowl/bib-bgr.html" title="Bibliographic Entry 21: Non-Archimedean Analysis">[21]</a>.</p>
<p id="p-97">\(\overline X/\FF_q\) a hyperelliptic curve of genus \(g\text{,}\) with odd degree model and monic, no repeated roots.</p>
<div class="displaymath">
\begin{equation*}
X\colon  \overline X \smallsetminus \{\infty , y= 0\}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\widetilde X
\end{equation*}
</div>
<p>is a lift of \(X\) to \(\ZZ_q\) the ring of Witt vectors over \(\FF_q\text{.}\)</p>
<div class="displaymath" id="p-98">
\begin{equation*}
y^2  =  \tilde P(x)\text{.}
\end{equation*}
</div>
<div class="displaymath" id="p-99">
\begin{equation*}
A \colon  \ZZ_q [x,y,y\inv]/(\tilde y^2 -\tilde P(x))
\end{equation*}
</div>
<p>\(A^\dagger\) the weak completion of \(A\text{,}\) this is</p>
<div class="displaymath">
\begin{equation*}
\left\{\sum_{-\infty }^\infty  s_n(x) y^n : s_n \in \ZZ_q[x],\,\deg s_n\le 2g,\, \ord_p(s_n) \gt c^n\text{ for some }c&gt; 0\right\}\text{.}
\end{equation*}
</div>
<p id="p-100">Monsky-Washnitzer cohomology is a \(p\)-adic cohomology theory for smooth affine varieties, over fields of characteristic \(p\text{.}\)</p>
<article class="theorem-like" id="theorem-11"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.25</span>. <span class="title">Special case, Berthelot, 1974, 1997).</span>
</h6>
<p id="p-101">The algebraic de Rham cohomology of \(\widetilde X\) coincides with the Monsky-Washnitzer cohomology of \(X\text{.}\)</p></article><p id="p-102">Monsky-Washnitzer cohomology is finite dimensional and is equipped with an action of Frobenius. So the theorem tells us that we can compute via a description of de Rham cohomology.</p>
<article class="theorem-like" id="proposition-1"><h6 class="heading">
<span class="type">Proposition</span> <span class="codenumber">2.26</span>.</h6>
<p id="p-103">The de Rham cohomology of \(A\) splits into eigenspaces under the hyperelliptic involution: a positive eigenspace generated by</p>
<div class="displaymath">
\begin{equation*}
\frac{x^i \diff x}{y^2},\,i=0,\ldots, 2g
\end{equation*}
</div>
<p>and a negative eigenspace generated by</p>
<div class="displaymath">
\begin{equation*}
\frac{x^i \diff x}{y},\,i=0,\ldots, 2g-1\text{.}
\end{equation*}
</div></article><p id="p-104">We lift \(p\)-power frobenius to an endomorphism of \(A^\dagger\) by defining it as the canonical Witt vector frobenius on \(\ZZ_q\text{.}\)</p>
<div class="displaymath">
\begin{equation*}
(a_0,a_1,\ldots)\mapsto (a_0^p, a_1^p,\ldots)
\end{equation*}
</div>
<p>for \(a_i\in \FF_q\text{,}\) then extend it to \(\ZZ_q\lb x\rb \) by mapping \(x\mapsto x^p\text{.}\) Then since \(y^2 = \tilde P(x)\text{,}\) we have</p>
<div class="displaymath">
\begin{equation*}
(y^\sigma )^2 = (y^2)^\sigma =(\tilde P(x))^\sigma 
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= (\tilde P(x))^\sigma  \left(\frac{y^2}{\tilde P(x)}\right)^p = \frac{y^{2p} \tilde P(x)^\sigma }{\tilde P(x)^p}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
y \mapsto y^p \left( \frac{\tilde P(x)^\sigma}{\tilde P(x)^p}\right)^{\frac 12}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
=      y^p \left(1 +  \frac{\tilde P(x)^\sigma - \tilde P(x)^p}{\tilde P(x)^p}\right)^{\frac 12}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
=      y^p \sum_{i=0}^\infty \binom{1/2}{i} \left(\frac{\tilde P(x)^\sigma - \tilde P(x)^p}{y^{2p}}\right)^i
\end{equation*}
</div>
<article class="remark-like" id="remark-6"><h6 class="heading">
<span class="type">Remark</span> <span class="codenumber">2.27</span>.</h6>
<p id="p-105">Here is why we removed the Weierstrass points (we don't want to divide by \(y\) and have things diverge). Its possible to compute a Frobenius lift without deleting Weierstrass points, but then we need to solve for images of \(x,y\) using a 2 variable newton iteration.</p></article><p id="p-106">Further extend to differentials by sending</p>
<div class="displaymath">
\begin{equation*}
\diff x\mapsto \diff(x^p) = px^{p-1} \diff x
\end{equation*}
</div>
<p>define \(F_\ast = \sigma ^{\log_pq}\) this is a lift of \(q\)-power frobenius.</p>
<p id="p-107">Key reduction lemmas, (to prove prop on eigenspaces).</p>
<article class="theorem-like" id="lemma-2"><h6 class="heading">
<span class="type">Lemma</span> <span class="codenumber">2.28</span>.</h6>
<p id="p-108">If \(A(x) = \tilde P(x) B(x) + \tilde P'C(x)\) then</p>
<div class="displaymath">
\begin{equation*}
\frac{A(x)\diff x}{y^2} = \left(B(x) + \frac{2C'(x)}{s-2}\right) \frac{\diff x}{y^{s-2}}
\end{equation*}
</div>
<p>as elements of \(H^1_{MW}(X)\text{.}\)</p></article><p id="p-109">We also  have</p>
<div class="displaymath">
\begin{equation*}
\diff(x^iy^j) = ix^{i-1}\diff x y^j  + x^i j y^{j-1} \diff y\text{,}
\end{equation*}
</div>
<p>use \(y^2 = \tilde P(x)\) which implies</p>
<div class="displaymath">
\begin{equation*}
\diff(y^2 = \tilde P(x))= 2y \diff y = \tilde P'(x) \diff x
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\implies \diff y = \frac{\tilde P'(x) \diff x}{2y}
\end{equation*}
</div>
<p>giving</p>
<div class="displaymath">
\begin{equation*}
\diff(x^iy^j) = ix^{i-1}y^j\diff x   + x^i j y^{j-1} \frac{\tilde P'(x) \diff x}{2y}\text{.}
\end{equation*}
</div>
<p id="p-110">A special case of this: let \(Q(x)  = x^{m-2g}\) then</p>
<div class="displaymath">
\begin{equation*}
\diff(Q(x) y) = (Q(x) \tilde P'(x) + 2Q'(x) \tilde P(x)) \frac{\diff x}{y} \equiv  0 \text{ in }H^1_{MW} (X)\text{.}
\end{equation*}
</div>
<p id="p-111">Goal for Coleman integration: We compute</p>
<div class="displaymath">
\begin{equation*}
\left(\frac{x^i \diff x}{y}\right)^\sigma 
\end{equation*}
</div>
<p>reduce using the above reductions to get a cohomologous differential that's a linear combination of the basis</p>
<div class="displaymath">
\begin{equation*}
\left\{ \frac{x^i \diff x}{y}\right\}_{i=0,\ldots, 2g-1}\text{.}
\end{equation*}
</div>
<p id="p-112">What does this look like?</p>
<ol class="decimal">
<li id="li-40">The reduction process is essentially  subtracting the right linear combinations of \(\diff(x^i y^j)\) and using \(y^2 = \tilde P(x)\text{.}\)</li>
<li id="li-41">Precision is lost when we divide by \(p\) in the reduction algorithm, so we'll need to measure the loss of precision at each step to know how many provably correct \(p\)-adic digits we have.</li>
</ol>
<p id="p-113">We compute</p>
<div class="displaymath">
\begin{equation*}
\left(\frac{x^i \diff x}{y}\right)^\sigma  = \frac{px^{pi + p - 1} \diff x }{y^p} \sum_{i=0}^L \binom{-1/2} i  \frac{(\tilde P(x) ^\sigma  - \tilde P(x)^p)^i}{y^{2pi}}
\end{equation*}
</div>
<p>we need to know how large \(L\) must be to get provably correct expansions.</p>
<p id="p-114">If the result of this is</p>
<div class="displaymath">
\begin{equation*}
\sum_{j = - M}^N \frac{A_j(x) \diff x}{y^{2j+1}}
\end{equation*}
</div>
<p>using the reduction formulas to eliminate the \(j=N\) term then the \(N-1\) term until no terms with \(j \gt  0\) remain. Do likewise with the \(j = -M, -M+1,\ldots\) terms.</p>
<p id="p-115">At the end of the reduction algorithm we are left with</p>
<div class="displaymath">
\begin{equation*}
\left(\frac{x^i \diff x}{y}\right)^\sigma  = \diff f_i +  \sum_{j=0}^{2g-1} M_{ji} \frac{x^j \diff x}{y}
\end{equation*}
</div>
<p>the \(\diff f_i\) is whats eliminated by the reduction algorithm, we sum the \(\diff\)'s at each step.</p>
<p id="p-116">Do this for each \(i = 0, \ldots, 2g  -1\text{.}\) Then \(M = (M_{ij})\) gives the matrix of Frobenius. Its characteristic polynomial gives you the numerator of the zeta function of \(X\text{.}\)</p>
<p id="p-117">Lemmas on precision:</p>
<article class="theorem-like" id="lemma-3"><h6 class="heading">
<span class="type">Lemma</span> <span class="codenumber">2.29</span>.</h6>
<p id="p-118">Let \(A(x) \in \ZZ_q\lb  x\rb \) be a polynomial of degree \(\le 2g\text{.}\) For some \(m \gt 0\) consider the reduction of</p>
<div class="displaymath">
\begin{equation*}
\omega = \frac{A(x)\diff x}{y^{2m + 1}}
\end{equation*}
</div>
<p>by Reduction 1</p>
<div class="displaymath">
\begin{equation*}
\omega = \frac{A(x)\diff x}{y^{2m + 1}} = \frac{B(x)\diff x}{y} + \diff f
\end{equation*}
</div>
<p>with \(B(x)\in \QQ_q\lb x\rb \) with \(\deg B(x)\le 2g-1\text{.}\) We have</p>
<div class="displaymath">
\begin{equation*}
p^{\floor*{\log_p(2m-1)}} B(x)\in \ZZ_q\lb x\rb \text{.}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
f = \sum_{k = -1}^{m-1} \frac{F_k (x)}{y^{2k+1}},\,\deg F_k  \le 2g\text{.}
\end{equation*}
</div></article><article class="theorem-like" id="lemma-4"><h6 class="heading">
<span class="type">Lemma</span> <span class="codenumber">2.30</span>.</h6>
<p id="p-119">Let \(A(x) \in \ZZ_q\lb  x\rb \) be a polynomial of degree \(\le 2g\text{.}\) For some \(m \gt 0\) consider the reduction of</p>
<div class="displaymath">
\begin{equation*}
\omega = \frac{A(x)y^{2m}\diff x}{y}
\end{equation*}
</div>
<p>by Reduction 2</p>
<div class="displaymath">
\begin{equation*}
\omega = \frac{A(x)y^{2m}\diff x}{y} = \frac{B(x)\diff x}{y} + \diff f
\end{equation*}
</div>
<p>with \(B(x)\in \QQ_q\lb x\rb \) with \(\deg B(x)\le 2g-1\text{,}\)</p>
<div class="displaymath">
\begin{equation*}
f = cy^{2m+1} + \sum_{k=0}^{m-1} F_k(x) y^{2k+1}
\end{equation*}
</div>
<p>\(c \in \QQ_q\text{,}\) \(\deg  F_k \le 2g\text{,}\) \(p^{\floor*{\log_p(2g+1)(2m+1)}} B(x)\in \ZZ_q\lb x\rb \) .</p></article><article class="theorem-like" id="proposition-2"><h6 class="heading">
<span class="type">Proposition</span> <span class="codenumber">2.31</span>.</h6>
<p id="p-120">To get \(N\) correct digits in the expansion after reduction we need to start with precision</p>
<div class="displaymath">
\begin{equation*}
N_1 = N + \max \left\{   \floor*{ \log_p(2M -3)},\floor*{ \log_p(2g+1)}\right\} + 1 + \floor*{\log_p(2g-1)}\text{,}
\end{equation*}
</div>
<p>where \(M\) is the smallest integer s.t.</p>
<div class="displaymath">
\begin{equation*}
M - \max\left\{ \floor*{\log_p(2M+1)},\floor*{\log_p(2g+1}) \right\}\text{.}
\end{equation*}
</div></article><article class="example-like" id="example-4"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.32</span>.</h6>
<p id="p-121">Let</p>
<div class="displaymath">
\begin{equation*}
y^2 = \tilde P(x) = x^3 + x+ 1/\QQ
\end{equation*}
</div>
<p>let \(p = 5\) (or take this over \(\FF_5\) and lift to \(\ZZ_5\)). Let \(N = 2\) be the number of correct 5-adic digits, so \(M =3\text{,}\) so \(N_1 = 3\text{,}\) use the differentials \(\frac{\diff x}{y},\frac{x\diff x}{y}\)</p>
<div class="displaymath">
\begin{equation*}
\left(\frac{\diff x}{y}\right)^\sigma = \left( \frac{25 x + 50}{y^{15}} + \frac{75 x^2 + 100x + 25 }{y^{13}} + \frac {50x^2 + 50x+100}{y^{11}} + \frac{75 x + 50}{y^9} + \frac{ 50x^2 + 50x }{y^7 } + \frac{70x^2 + 70 x +  25}{y^5} + \frac{5x}{y^3} \right)\diff x \pmod {5^3}
\end{equation*}
</div>
<p>similar for</p>
<div class="displaymath">
\begin{equation*}
\left(\frac{x\diff x}{y}\right)^\sigma = \left( \frac{100x^2 + 100x + 75}{y^{15}} + \cdots \right)\diff x \pmod {5^3}
\end{equation*}
</div>
<p>let \(F_k\) be the polynomial in the term</p>
<div class="displaymath">
\begin{equation*}
\frac{F_k\diff x}{y^{2k +1}}
\end{equation*}
</div>
<p>starting from \(k = 7\text{,}\) set \(s_k(x) = F_k(x)\text{,}\) compute a series of polynomials inductively for \(k-1,k-2, \ldots, 0\text{.}\) Given \(S_{k+1}\) find polynomials \(A_{k+1}, B_{k+1}\) s.t.</p>
<div class="displaymath">
\begin{equation*}
A_{k+1}\tilde P + B_{k+1} \tilde P ' = s_{k+1}
\end{equation*}
</div>
<p>then set \(s_k(x) = F_k(x)  + A_{k+1}(x) + \frac{2B'_{k+1}(x)}{2k+1}\)</p>
<div class="displaymath">
\begin{equation*}
\left(\frac{\diff x}{y}\right)^\sigma = 15x \frac{\diff x}{y}\pmod {5^2}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\left(\frac{x\diff x}{y}\right)^\sigma = (22x+18) \frac{\diff x}{y}\pmod {5^2}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
M = \begin{pmatrix} 0 \amp 18 \\ 15 \amp 22\end{pmatrix}\pmod{5^2}\text{.}
\end{equation*}
</div></article></section></section></div></main>
</div>
<!--Start: Google Classic code-->
<script>
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-48250536-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
<!--End: Google Classic code-->
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.12/login.js"></script>
</body>
</html>
